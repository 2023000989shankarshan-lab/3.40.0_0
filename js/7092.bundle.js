"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[7092],{5898:(n,e,r)=>{r.d(e,{FK:()=>q,MK:()=>U,SP:()=>T,SW:()=>D,Sy:()=>S,TR:()=>A,UI:()=>M,qG:()=>x,uQ:()=>F,wl:()=>k});var t,a,i,o,u,s,c,g,m,d,l,p,f,b,z,O=r(45322),v=r(2972),y=r(73481),h=r(83362),$=(0,v.gql)(t||(t=(0,O.A)(["\n  fragment OrganizationMemberFragment on OrganizationMember {\n    role\n    seatType\n    lastActive\n    user {\n      id\n      name\n      username\n      image\n      isPlus\n    }\n  }\n"]))),I=(0,v.gql)(a||(a=(0,O.A)(["\n  fragment OrganizationFragment on Organization {\n    id\n    name\n    image\n    seats\n    activeSeats\n    status\n\n    members {\n      ...OrganizationMemberFragment\n    }\n  }\n\n  ","\n"])),$),w=(0,v.gql)(i||(i=(0,O.A)(["\n  fragment UserOrganizationFragment on UserOrganization {\n    role\n    referralToken\n    referralUrl\n    seatType\n  }\n"]))),A=((0,v.gql)(o||(o=(0,O.A)(["\n  query Organizations {\n    organizations {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),w,I),(0,v.gql)(u||(u=(0,O.A)(["\n  query Organization($id: ID!) {\n    organization(id: $id) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),w,I)),k=((0,v.gql)(s||(s=(0,O.A)(["\n  query GetOrganizationByIdAndInviteToken($id: ID!, $token: String!) {\n    getOrganizationByIdAndInviteToken(id: $id, token: $token) {\n      user {\n        ...UserShortInfo\n      }\n      organization {\n        id\n        name\n        image\n        seats\n        activeSeats\n      }\n    }\n  }\n\n  ","\n"])),y.fT),(0,v.gql)(c||(c=(0,O.A)(["\n  mutation UpdateOrganization($id: ID!, $name: String, $image: Upload) {\n    updateOrganization(id: $id, name: $name, image: $image) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),w,I)),q=(0,v.gql)(g||(g=(0,O.A)(["\n  mutation JoinOrganization($id: ID!, $token: String!) {\n    joinOrganization(id: $id, token: $token) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),w,I),S=(0,v.gql)(m||(m=(0,O.A)(["\n  mutation LeaveOrganization($id: ID!) {\n    leaveOrganization(id: $id) {\n      _\n    }\n  }\n"]))),F=(0,v.gql)(d||(d=(0,O.A)(["\n  mutation UpdateOrganizationSubscription($id: ID!, $quantity: Int!) {\n    updateOrganizationSubscription(id: $id, quantity: $quantity) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n  ","\n  ","\n"])),w,I),x=(0,v.gql)(l||(l=(0,O.A)(["\n  query PreviewOrganizationSubscriptionUpdate(\n    $id: ID!\n    $quantity: Int!\n    $locale: String\n  ) {\n    previewOrganizationSubscriptionUpdate(\n      id: $id\n      quantity: $quantity\n      locale: $locale\n    ) {\n      pricing {\n        priceId\n        duration\n        currency {\n          code\n        }\n        price {\n          amount\n          monthly {\n            amount\n          }\n        }\n        metadata {\n          ...PricingMetadataFragment\n        }\n      }\n      nextBilling\n      total {\n        amount\n      }\n      prorated {\n        total {\n          amount\n        }\n        tax {\n          amount\n        }\n        subTotal {\n          amount\n        }\n      }\n    }\n  }\n\n  ","\n"])),h.QJ),U=(0,v.gql)(p||(p=(0,O.A)(["\n  mutation DeleteOrganization($id: ID!) {\n    deleteOrganization(id: $id) {\n      _\n    }\n  }\n"]))),T=(0,v.gql)(f||(f=(0,O.A)(["\n  mutation RemoveOrganizationMember($id: ID!, $memberId: String!) {\n    removeOrganizationMember(id: $id, memberId: $memberId) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n\n  ","\n  ","\n"])),w,I),D=(0,v.gql)(b||(b=(0,O.A)(["\n  mutation UpdateOrganizationMemberRole(\n    $id: ID!\n    $memberId: String!\n    $role: OrganizationMemberRole!\n  ) {\n    updateOrganizationMemberRole(id: $id, memberId: $memberId, role: $role) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n\n  ","\n  ","\n"])),w,I),M=(0,v.gql)(z||(z=(0,O.A)(["\n  mutation ToggleOrganizationMemberSeat($id: ID!, $memberId: String!) {\n    toggleOrganizationMemberSeat(id: $id, memberId: $memberId) {\n      ...UserOrganizationFragment\n      organization {\n        ...OrganizationFragment\n      }\n    }\n  }\n\n  ","\n  ","\n"])),w,I)},47092:(n,e,r)=>{r.d(e,{Z5:()=>F,aT:()=>h});var t=r(21441),a=r(35001),i=r(13318),o=r.n(i),u=r(5698),s=r(77535),c=r(80009),g=r(80446),m=r(36899),d=r(5898),l=r(68630),p=r(30530),f=r(80244),b=r(68392),z=r(54883),O=r(4202);function v(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,t)}return r}function y(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){(0,t.A)(n,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))}))}return n}var h=function(n,e){for(var r=arguments.length,t=new Array(r>2?r-2:0),a=2;a<r;a++)t[a-2]=arguments[a];return p.$h.apply(void 0,[p.jZ.Organizations,n,e].concat(t))},$=function(){var n=(0,a.A)(o().mark((function n(e){var r,t,a,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=e.form,a={id:r,name:t.name,image:t.image},n.next=4,m.e.request(d.wl,a);case 4:return i=n.sent,n.abrupt("return",i.updateOrganization);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),I=function(){var n=(0,a.A)(o().mark((function n(e){var r,t,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=e.memberId,n.next=3,m.e.request(d.SP,{id:r,memberId:t});case 3:return a=n.sent,n.abrupt("return",a.removeOrganizationMember);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),w=function(){var n=(0,a.A)(o().mark((function n(e){var r,t,a,i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=e.memberId,a=e.role,n.next=3,m.e.request(d.SW,{id:r,memberId:t,role:a});case 3:return i=n.sent,n.abrupt("return",i.updateOrganizationMemberRole);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),A=function(){var n=(0,a.A)(o().mark((function n(e){var r,t,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.id,t=e.memberId,n.next=3,m.e.request(d.UI,{id:r,memberId:t});case 3:return a=n.sent,n.abrupt("return",a.toggleOrganizationMemberSeat);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),k=function(){var n=(0,a.A)(o().mark((function n(e){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",m.e.request(d.MK,{id:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),q=function(){var n=(0,a.A)(o().mark((function n(e){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",m.e.request(d.Sy,{id:e}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),S=function(){var n=(0,a.A)(o().mark((function n(e){var r,t,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.token,t=e.organizationId,n.next=3,m.e.request(d.FK,{id:t,token:r});case 3:return a=n.sent,n.abrupt("return",a.joinOrganization);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(n,e){var r,t,i,v,F,x=(0,g.useRouter)(),U=(0,b.mu)().displayToast,T=(0,f.Z2)(),D=T.user,M=T.isAuthReady,j=T.refetchBoot,P=!!n&&!!D&&M,E=h(D,n),R=(0,u.jE)(),K=(0,s.I)(y(y({queryKey:E,queryFn:(r=(0,a.A)(o().mark((function e(){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.e.request(d.TR,{id:n});case 2:return r=e.sent,e.abrupt("return",(null==r?void 0:r.organization)||null);case 4:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)}),staleTime:p.b2.Default},e),{},{enabled:void 0!==(null==e?void 0:e.enabled)?e.enabled&&P:P})),Q=K.data,Z=K.isFetching,B=function(){var n=(0,a.A)(o().mark((function n(e){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",R.setQueryData(E,(function(){return e})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),J=function(n){var e=n.message,r=n.callback;return function(){var n=(0,a.A)(o().mark((function n(t){var a,i,u,s=arguments;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,B(t);case 2:if(e&&U(e),!r){n.next=7;break}for(a=s.length,i=new Array(a>1?a-1:0),u=1;u<a;u++)i[u-1]=s[u];return n.next=7,r.apply(void 0,i);case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},W=function(n){var e;U((null==n||null===(e=n.response)||void 0===e||null===(e=e.errors)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.message)||m.XW)},C=(0,c.n)({mutationFn:function(e){var r=e.form;return $({id:n,form:r})},onSuccess:J({message:"The organization has been updated"}),onError:W}),G=C.mutateAsync,L=C.isPending,_=(0,c.n)({mutationFn:function(e){var r=e.memberId;return I({id:n,memberId:r})},onSuccess:J({message:"The organization member has been removed"}),onError:W}).mutate,X=(0,c.n)({mutationFn:function(e){var r=e.memberId,t=e.role;return w({id:n,memberId:r,role:t})},onSuccess:J({message:"The organization member role has been updated"}),onError:W}),H=X.mutate,N=(0,c.n)({mutationFn:function(e){var r=e.memberId;return A({id:n,memberId:r})},onSuccess:J({message:"The organization member seat has been toggled",callback:(t=(0,a.A)(o().mark((function n(e){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.memberId!==D.id){n.next=4;break}return n.next=4,j();case 4:case"end":return n.stop()}}),n)}))),function(n){return t.apply(this,arguments)})}),onError:W}),V=N.mutate,Y=(0,c.n)({mutationFn:function(){return k(n)},onSuccess:(i=(0,a.A)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:R.invalidateQueries({queryKey:(0,p.$h)(p.jZ.Organizations,D)}),x.replace("".concat(z.vb,"/organization"));case 2:case"end":return n.stop()}}),n)}))),function(){return i.apply(this,arguments)}),onError:W}),nn=Y.mutateAsync,en=Y.isPending,rn=(0,c.n)({mutationFn:function(){return q(n)},onSuccess:(v=(0,a.A)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return R.invalidateQueries({queryKey:(0,p.$h)(p.jZ.Organizations,D)}),n.next=3,j();case 3:x.replace("".concat(z.vb,"/organization"));case 4:case"end":return n.stop()}}),n)}))),function(){return v.apply(this,arguments)}),onError:W}),tn=rn.mutateAsync,an=rn.isPending,on=(0,c.n)({mutationFn:function(e){return S({token:e,organizationId:n})},onSuccess:J({callback:(F=(0,a.A)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x.push((0,O.K)(n,"members")),e.next=3,j();case 3:case"end":return e.stop()}}),e)}))),function(){return F.apply(this,arguments)})}),onError:W}),un=on.mutateAsync,sn=on.isPending,cn=Q||{},gn=cn.organization,mn=cn.role,dn=cn.referralToken,ln=cn.referralUrl,pn=cn.seatType;return{organization:gn,seats:{total:(null==gn?void 0:gn.seats)||0,assigned:(null==gn?void 0:gn.activeSeats)||0,available:((null==gn?void 0:gn.seats)||0)-((null==gn?void 0:gn.activeSeats)||0)},role:mn,referralToken:dn,referralUrl:ln,seatType:pn,isFetching:Z,updateOrganization:G,isUpdatingOrganization:L,isOwner:mn===l.S.Owner,deleteOrganization:nn,isDeletingOrganization:en,leaveOrganization:tn,isLeavingOrganization:an,joinOrganization:un,isJoiningOrganization:sn,removeOrganizationMember:_,updateOrganizationMemberRole:H,toggleOrganizationMemberSeat:V}}},4202:(n,e,r)=>{r.d(e,{K:()=>a});var t=r(54883),a=function(n,e){return"".concat(t.vb,"/organization/").concat(n).concat(e?"/".concat(e):"")}}}]);