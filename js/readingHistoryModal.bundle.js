"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[2970],{79664:(e,t,n)=>{n.r(t),n.d(t,{ReadingHistoryModal:()=>he,default:()=>be});var a=n(22155),r=n(94198),o=n(59645),i=n(30395),l=n.n(i),s=n(95974),c=n(55059),u=n(81954),d=n(74921),p=n(67371),f=n(63423),m=n(7986),v=n(38638),g=n(41536),y=n(27504),h=n(16763),b=n(5698),x=n(80244),w=n(30530),P=n(90087),O=n(34091),k=function(){var e=(0,b.jE)(),t=(0,a.useContext)(x.Ay).user;return(0,P.o)({variables:{key:w.jZ.ReadingHistory},onMutate:function(n){var a=n.id,r=n.vote,o=e.getQueryData((0,w.$h)(w.jZ.ReadingHistory,t));return(0,O.p)({id:a,vote:r,data:o,user:t,queryClient:e})}})},N=n(57952),j=n(53823),D=n(83448),S=n(19505),A=n(87822),F=n(35001),C=n(33998),M=n(34900),R=n(21441),H=n(13318),q=n.n(H),E=n(75487),I=n(69797),L=n(20861),z=n(60471),$=n(74751),Z=n(73216),K=n(72549),T=["secondary"],B=a.createElement;function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,R.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t,n=e.post,r=e.indexes,o=e.onHide,i=(0,a.useState)(!1),s=i[0],c=i[1],u=(0,x.Z2)().user,d=(0,b.jE)(),f=(0,w.$h)(w.jZ.ReadingHistory,u),m=(0,Z.C)({onMutate:function(){var e=function(e,t,n,a){var r=a.page,o=a.edge;return function(){var a=e.getQueryData(t),i=((null==a?void 0:a.pages[r].readHistory.edges[o])||{}).node,l=Y(Y({},i),{},{post:Y(Y({},null==i?void 0:i.post),n)});return(0,w.K9)({client:e,edge:o,page:r,entity:l,prop:"readHistory",queryKey:t}),function(){return e.setQueryData(t,a)}}}(d,f,{bookmarked:!(null!=n&&n.bookmarked)},r);return e()}}),v=m.toggleBookmark,g=function(){var e=(0,F.A)(q().mark((function e(){return q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v({post:n,origin:N.$e.ReadingHistoryContextMenu});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=N.$e.ReadingHistoryContextMenu,h=(0,K.P)(y).openSharePost,P=[{icon:B($.Z,{Icon:L.l}),label:"Share post via...",action:function(e){e.preventDefault(),c(!1),h({post:n})}},{icon:(t=null==n?void 0:n.bookmarked,B($.Z,{Icon:function(e){e.secondary;var n=(0,M.A)(e,T);return B(I.c,(0,C.A)({secondary:t},n,{className:l()(n.className,t&&"text-accent-bun-default")}))}})),label:null!=n&&n.bookmarked?"Remove from bookmarks":"Save to bookmarks",action:function(e){e.preventDefault(),c(!1),g()}},{icon:B($.Z,{Icon:p.d}),label:"Remove post",action:function(e){e.preventDefault(),c(!1),null==o||o()}}];return B(E.rI,{open:s,onOpenChange:c},B(E.ty,{asChild:!0},B(j.$n,{variant:D.Ak.Tertiary,"data-testid":"post-item-".concat(n.id),icon:B(z.Z,null),onClick:function(e){e.stopPropagation(),e.preventDefault()},size:D.Mp.Small})),B(E.SQ,null,B(E.x3,{options:P})))},Q=a.createElement,V=(0,f.A)("div","absolute left-5 -my-1 w-8 h-8 bg-background-default");function G(e){var t,n,r,o,i,f,b=e.postItem,x=e.showButtons,w=void 0===x||x,P=e.clickable,O=void 0===P||P,F=e.onHide,C=e.className,M=e.showVoteActions,R=void 0!==M&&M,H=e.logOrigin,q=void 0===H?N.$e.Feed:H,E=e.indexes,I=b.timestampDb,L=b.post,z=null!==(t=null==L?void 0:L.sharedPost)&&void 0!==t?t:L,$=(0,A.OR)(L.source),Z=k(),K=Z.toggleUpvote,T=Z.toggleDownvote,B=l()("relative flex w-full flex-row py-3 pl-9 pr-5",R?"items-start tablet:items-center":"items-center",O&&"hover:cursor-pointer hover:bg-surface-hover",C),U=(null==L?void 0:L.title)||(null==L||null===(n=L.sharedPost)||void 0===n?void 0:n.title);return Q("article",{className:l()(!O&&B)},Q(y.A,{condition:O,wrapper:function(e){return Q(s.A,{href:L.commentsPermalink},Q("a",{className:B,title:"Go to post"},e))}},Q(a.Fragment,null,Q(g._V,{src:z.image,alt:L.title,className:"h-16 w-16 rounded-16 object-cover laptop:w-24",loading:"lazy",fallbackSrc:h.uC}),Q(V,{className:l()(R&&"top-8",$?"rounded-12":"rounded-full")}),Q(v.Y3,{size:v.Ov.Small,rounded:$?v.Ov.Small:"full",className:l()("absolute left-6",R&&"top-8"),user:{image:$?L.author.image:L.source.image,username:"source of ".concat(U)},nativeLazyLoading:!0}),Q("div",{className:l()("flex flex-1",R?"flex-col tablet:flex-row":"items-center")},Q("div",{className:"ml-4 flex flex-1 flex-col"},Q("h3",{className:"mr-6 line-clamp-2 flex flex-1 break-words text-left typo-callout"},U),Q(m.A,{readTime:L.readTime,numUpvotes:L.numUpvotes,isVideoType:(0,c.CX)(L)})),Q("div",{className:"ml-4 mt-1 flex tablet:ml-0 tablet:mt-1"},w&&R&&Q(a.Fragment,null,Q(j.$n,{size:D.Mp.Small,variant:D.Ak.Tertiary,color:R?S.h.Avocado:void 0,className:R?"flex":"hidden laptop:flex",pressed:(null==L||null===(r=L.userState)||void 0===r?void 0:r.vote)===c.mj.Up,onClick:function(e){e.preventDefault(),K({payload:L,origin:q})},icon:Q(u.l,{secondary:(null==L||null===(o=L.userState)||void 0===o?void 0:o.vote)===c.mj.Up})}),Q(j.$n,{size:D.Mp.Small,variant:D.Ak.Tertiary,color:R?S.h.Ketchup:void 0,className:R?"flex":"hidden laptop:flex",pressed:(null==L||null===(i=L.userState)||void 0===i?void 0:i.vote)===c.mj.Down,onClick:function(e){e.preventDefault(),T({payload:L,origin:q})},icon:Q(d.y,{secondary:(null==L||null===(f=L.userState)||void 0===f?void 0:f.vote)===c.mj.Down})})),w&&!R&&F&&Q(j.$n,{size:D.Mp.Small,variant:D.Ak.Tertiary,className:"hidden laptop:flex",icon:Q(p.d,null),onClick:function(e){e.stopPropagation(),e.preventDefault(),F({postId:L.id,timestamp:I})}}),w&&Q(X,{post:L,indexes:E,onHide:F?function(){return F({postId:L.id,timestamp:I})}:void 0}))))))}var W=n(13707),_=n(97838),J=a.createElement;function ee(e){var t=e.onArticleClick,n=e.data,a=e.canFetchMore,r=e.isFetchingNextPage,i=e.fetchNextPage;return J(o.A,{canFetchMore:a,fetchNextPage:i,isFetchingNextPage:r},null==n?void 0:n.map((function(e){return J("button",{key:"".concat(e.post.id,"-").concat(e.timestamp),type:"button",className:"group relative -mx-6 cursor-pointer hover:bg-surface-hover",onClick:function(n){return t(n,e)},"aria-label":"Reading history item"},J(G,{postItem:e,showButtons:!1,clickable:!1}),J(W.HK,{size:_.lK.Medium,className:"absolute right-3 top-1/2 hidden -translate-y-1/2 rotate-90 group-hover:flex"}))})))}var te=n(42104),ne=n(69135),ae=n(36899),re=n(27724);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){(0,R.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const le=function(e){var t,n=e.key,r=e.query,o=e.variables,i=(0,ne.q)({queryKey:n,queryFn:function(e){var t=e.pageParam;return ae.e.request(r,ie(ie({},o),{},{after:t}))},initialPageParam:"",getNextPageParam:function(e){var t=e.readHistory;return(0,w.iP)(null==t?void 0:t.pageInfo)}}),l=i.isPending,s=i.isFetchingNextPage,c=i.hasNextPage,u=i.data,d=i.fetchNextPage,p=!l&&!s&&c&&u.pages.length>0,f=(0,re.A)({fetchPage:d,canFetchMore:p}),m=null==u||null===(t=u.pages)||void 0===t?void 0:t.some((function(e){return e.readHistory.edges.length>0}));return(0,a.useMemo)((function(){return{queryResult:i,hasData:m,isLoading:l,data:u,isInitialLoading:!m&&l,infiniteScrollRef:f}}),[m,i,l,u,f])};var se=function(){var e=(0,a.useContext)(x.Ay).user,t={key:["readHistory",null==e?void 0:e.id],query:te.tN,variables:{isPublic:!0}},n=le(t),r=n.hasData,i=n.data,l=n.isInitialLoading,s=n.isLoading,c=n.queryResult;return{data:(0,a.useMemo)((function(){return null==i?void 0:i.pages.map((function(e){return e.readHistory.edges.map((function(e){return e.node}))})).flat()}),[i]),hasData:r,isInitialLoading:l,isLoading:s,queryResult:c,canFetchMore:(0,o.c)(c),fetchNextPage:c.fetchNextPage,isFetchingNextPage:c.isFetchingNextPage}},ce=n(7186),ue=a.createElement;function de(e){var t=e.hasNoData;return ue(a.Fragment,null,ue(ce.$d,{className:"hidden tablet:block"},t?"Read":"Share"," ",ue(ce.wF,null,"a post")),ue("p",{className:"py-4 text-center"},t?"Your reading history is empty! Please read at least one post by clicking on a post to start sharing with your Squad.":"Pick a post that you would like to discuss with your Squad members."))}var pe=n(9062),fe=a.createElement,me=(0,f.A)(pe._,"h-3 rounded-12");const ve=function(e){var t=e.amount,n=void 0===t?7:t;return fe("div",{className:"flex flex-col"},Array(Math.max(0,n)).fill(0).map((function(e,t){return fe("div",{key:t,className:"flex flex-row items-center px-8 py-3"},fe(pe._,{className:"h-16 w-16 rounded-16 laptop:w-24"}),fe("div",{className:"ml-4 flex flex-1 flex-col"},fe(me,{className:"w-full laptop:w-1/2"}),fe(me,{className:"mt-2 w-2/3 laptop:w-1/3"})))})))};var ge=n(77955),ye=a.createElement;function he(e){var t=e.keepOpenAfterSelecting,n=e.onArticleSelected,a=e.onRequestClose,o=se(),i=o.hasData,l=o.isInitialLoading,s=o.data,c=o.isLoading,u=o.canFetchMore,d=o.fetchNextPage,p=o.isFetchingNextPage,f=!i&&!l,m=f?"Read":"Share";return ye(r.aF,{isOpen:!0,onRequestClose:a,kind:r.aF.Kind.FixedCenter,size:r.aF.Size.Small},ye(r.aF.Header,{className:"flex tablet:hidden",kind:ge.Vq.Primary,title:"".concat(m," a post")}),ye(r.aF.Body,null,ye(de,{hasNoData:f}),ye(ee,{onArticleClick:function(e,r){n(r),t||a(e)},data:s,canFetchMore:u,fetchNextPage:d,isFetchingNextPage:p}),c&&ye(ve,{amount:l?15:1})))}const be=he},7186:(e,t,n)=>{n.d(t,{$d:()=>g,D4:()=>b,Eh:()=>h,jG:()=>x,wF:()=>y});var a=n(21441),r=n(22155),o=n(63423),i=n(67380),l=n(16714),s=n(87822),c=n(25316),u=n(97838),d=n(77955),p=n(48389),f=r.createElement;function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t=e.children,n=e.className;return f(i.o5,{className:n,tag:i.UL.H1,type:i.kR.LargeTitle,bold:!0},t)},y=(0,o.A)("span","text-brand-default"),h=((0,o.A)(l.mf,"!p-0 laptop:min-h-page h-full !max-w-[42.5rem] !w-full",l.hC),(0,o.A)("div","flex flex-1 flex-col"),function(e){return(null==e?void 0:e.moderationRequired)&&!(0,p.pZ)(e,s.Wk.ModeratePost)}),b={title:"Your post has been submitted for review",description:"Your post is now waiting for the admin's approval. We'll notify you once it's been reviewed.",okButton:{title:"Got it",className:"tablet:w-full"},cancelButton:null,promptSize:d.rI.XSmall,icon:f(c.x,{size:u.lK.XXXLarge})},x=v(v({},b),{},{title:"Your edit has been submitted for review",description:"Your edit is now waiting for the admin’s approval. We’ll notify you once it’s been reviewed."})}}]);