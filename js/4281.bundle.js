"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[4281],{74281:(e,t,r)=>{r.r(t),r.d(t,{StoreKitSubProvider:()=>h});var n=r(35001),a=r(13318),u=r.n(a),c=r(22155),i=r(77535),s=r(20573),o=r(63815),l=r(80244),d=r(30530),p=r(83362),v=r(80197),f=r(35600),b=c.createElement,h=function(e){var t,r=e.children,a=e.successCallback,h=(0,l.Z2)(),P=h.user,y=h.isValidRegion,k=(0,i.I)({queryKey:(0,d.$h)(d.jZ.PriceMetadata,P,p.sE.Plus),queryFn:function(){return(0,p.U8)(p.sE.Plus)},enabled:!!P&&(0,o.B6)(),staleTime:d.b2.Default}).data,C=(0,i.I)({queryKey:(0,d.$h)(d.jZ.PricePreview,P,p.sE.Plus),enabled:!(null==k||!k.length)&&(0,o.B6)(),staleTime:d.b2.Default,queryFn:(t=(0,n.A)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,v.bn)(k));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}),g=C.data,m=(0,f.R)({type:p.sE.Plus,products:g,successCallback:a}).openCheckout,R=(0,c.useMemo)((function(){return{openCheckout:m,productOptions:g,isPlusAvailable:y,giftOneYear:void 0,isPricesPending:!1}}),[y,m,g]);return b(s.Qv.Provider,{value:R},r)}},35600:(e,t,r)=>{r.d(t,{R:()=>f});var n=r(22155),a=r(36899),u=r(68390),c=r(57952),i=r(49556),s=r(80244),o=r(63815),l=r(68392),d=r(61663),p=r(80197),v={cores:o.NB.IAPCoresPurchase,plus:o.NB.IAPSubscriptionRequest,organization:o.NB.IAPSubscriptionRequest},f=function(e){var t,r=e.type,f=e.products,b=e.successCallback,h=c.E4[r],P=v[r],y=(0,l.mu)().displayToast,k=(0,s.Z2)().user,C=(0,n.useRef)(b);C.current=b;var g=(0,d.DX)().logEvent,m=(0,n.useRef)(g);m.current=g;var R=(0,n.useCallback)((function(e){var t,r=e.priceId;(0,o.Ks)(P,{productId:r,appAccountToken:null==k||null===(t=k.subscriptionFlags)||void 0===t?void 0:t.appAccountToken})}),[null==k||null===(t=k.subscriptionFlags)||void 0===t?void 0:t.appAccountToken,P]);return(0,n.useEffect)((function(){var e="iap-purchase-event";return(0,u.HD)(e,(function(e){var t,r=e.detail,n=r.name,u=r.detail,s=r.product,o=null==f?void 0:f.find((function(e){var t;return e.priceId===(null==s||null===(t=s.attributes)||void 0===t?void 0:t.offerName)}));switch(n){case p.Rc.PurchaseCompleted:m.current({event_name:c.VB.CompleteCheckout,target_type:h,extra:JSON.stringify({quantity:o.metadata.coresValue,user_id:null==k?void 0:k.id,cycle:o.duration,localCost:s.attributes.offers[0].price,localCurrency:s.attributes.offers[0].currencyCode,payment:i.d.AppleStoreKit})}),null===(t=C.current)||void 0===t||t.call(C,e);break;case p.Rc.PurchaseInitiated:m.current({event_name:c.VB.InitiatePayment,target_type:h});break;case p.Rc.PurchaseFailed:m.current({event_name:c.VB.ErrorCheckout,target_type:h,extra:JSON.stringify({errorCode:u})}),y(a.XW);break;case p.Rc.PurchasePending:y("Please wait for the purchase to be completed.");case p.Rc.PurchaseCancelled:}}),{once:!1}),function(){var t;null===globalThis||void 0===globalThis||null===(t=globalThis.eventControllers)||void 0===t||null===(t=t[e])||void 0===t||t.abort()}}),[y,f,h,null==k?void 0:k.id]),{openCheckout:R}}}}]);