"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[9706],{52817:(e,t,r)=>{r.r(t),r.d(t,{default:()=>fe});var a=r(14728),n=r(33998),o=r(21441),l=r(35001),i=r(13318),c=r.n(i),s=r(22155),u=r(30395),d=r.n(u),p=r(77535),m=r(80009),f=r(94198),v=r(67380),y=r(53823),A=r(83448),w=r(96888),g=r(13707),C=r(41536),S=r(16763),b=r(80446),k=r(61663),O=r(11924),P=r(57952),x=r(68390),N=r(54883),R=r(70591),h=r(95092),j=s.createElement;function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function E(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var T="INTRO",B="COMMENT",D="SUCCESS",M="AWARD",U={USER:{START:P.VB.StartAwardUser,PICK:P.VB.PickAwardUser,AWARD:P.VB.AwardUser},POST:{START:P.VB.StartAwardPost,PICK:P.VB.PickAwardPost,AWARD:P.VB.AwardPost},COMMENT:{START:P.VB.StartAwardComment,PICK:P.VB.PickAwardComment,AWARD:P.VB.AwardComment},SQUAD:{START:P.VB.StartAwardSquad,PICK:P.VB.PickAwardSquad,AWARD:P.VB.AwardSquad}},I=s.createContext(void 0);var V=function(e){var t=e.children,r=e.onRequestClose,a=e.type,n=e.entity,o=e.post,l=e.flags,i=(0,b.useRouter)(),c=(0,k.DX)().logEvent,u=(0,s.useState)({screen:T}),d=u[0],p=u[1],m=(0,s.useState)(M),f=m[0],v=m[1],y=(0,h.Qf)(["(prefers-reduced-motion)"],[!0],!1,!1),A=(0,s.useCallback)((function(e){var t,r=e.awardEvent,n=e.extra,l=null===(t=U[a])||void 0===t?void 0:t[r];["USER","SQUAD"].includes(a)?c({event_name:l,extra:JSON.stringify(E({},n))}):c((0,O.P5)(l,o,{extra:n}))}),[c,o,a]),w=(0,s.useMemo)((function(){return{activeModal:f,setActiveModal:function(e){if("BUY_CORES"===e&&(0,x.oX)()){var t=new URLSearchParams({origin:P.$e.Award});return null!=o&&o.id&&t.append("next","/posts/".concat(o.id)),void(null==i||i.replace((0,R.Lz)("".concat(N.ZO,"cores"),t)))}v(e)},onRequestClose:function(e){!y&&"SUCCESS"===d.screen&&d.product?v("AWARD_ANIMATION"):null==r||r(e)},activeStep:d.screen,product:d.product,setActiveStep:p,type:a,entity:n,logAwardEvent:A,post:o,flags:l}}),[f,r,d.screen,d.product,a,n,A,i,o,y,l]);return j(I.Provider,{value:w},t)},z=function(){return(0,s.useContext)(I)},K=r(16714),X=r(24481),_=r(72870),q=r(77955),L=r(97838),W=r(75653),G=r(12602),$=r(37567),Z=r(81602),Y=r(80244),H=r(76800),Q=s.createElement,J=function(e){var t=e.className;return Q(v.o5,{type:v.kR.Footnote,color:v.X8.Quaternary,className:d()("text-center",t)},"Awards may include a revenue share with the recipient and are subject to our"," ",Q("a",{href:N.pc,target:"_blank",rel:H.O8,className:"font-bold underline"},"Terms of Service"),".")},ee=r(73855),te=r(13713),re=r(58163),ae=r(89883),ne=r(53304),oe=s.createElement;function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){(0,o.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ce=function(e){var t=e.item,r=e.onClick,a=z().logAwardEvent;return oe(y.$n,{variant:A.Ak.Float,className:"flex !h-auto flex-col items-center justify-center rounded-14 bg-surface-float !p-1",onClick:function(e){return a({awardEvent:"PICK",extra:{award:t.value}}),r({product:t,event:e})}},oe(C._V,{src:t.image,alt:t.name,className:"size-20 object-contain"}),oe("div",{className:"flex items-center justify-center gap-1"},oe(w.t,{size:L.lK.Size16}),oe(v.o5,{type:v.kR.Footnote,color:v.X8.Secondary,tag:v.UL.Span},0===t.value?"Free":(0,ee.rZ)(t.value))))},se=function(){var e,t=(0,ae.d)().openModal,r=(0,s.useState)(!1),a=r[0],n=r[1],o=(0,Y.Z2)().user,l=z(),i=l.onRequestClose,c=l.entity,u=l.type,m=l.setActiveModal,g=l.setActiveStep,b=l.product,k=l.post,O=(0,_.G6)(_.bh.MobileL),P=(0,te.P_)(),x=(0,p.I)((0,$.H9)()).data,N=function(){n(!1),m("BUY_CORES")},R=!!c.numAwards;return oe(s.Fragment,null,oe(f.aF.Header,{showCloseButton:!O,className:d()(O?"flex-row-reverse justify-between":void 0)},oe(W.T,{hideBuyButton:!P,onPlusClick:N}),O?oe(y.$n,{onClick:i,variant:A.Ak.Tertiary,size:A.Mp.Small,className:"mr-2"},"Close"):null),oe(f.aF.Body,{className:"gap-2 bg-gradient-to-t from-theme-overlay-to to-transparent tablet:rounded-b-16"},oe("div",{className:"flex flex-col items-center justify-center gap-2 px-4"},oe(C._V,{src:R?S.Xr:c.receiver.image,alt:"Award user",className:R?"size-[7.5rem]":"size-16 rounded-18"}),oe(v.o5,{type:v.kR.Title3,bold:!0,color:v.X8.Primary},R?oe(s.Fragment,null,(0,Z.Kt)(c.numAwards)," Award",1===c.numAwards?"":"s"," given"):oe(s.Fragment,null,"Give an Award"))),R&&oe(y.$n,{className:"mx-auto max-w-28",size:A.Mp.Small,variant:A.Ak.Float,onClick:function(){t({type:q.K2.ListAwards,props:{onBack:function(){t({type:q.K2.GiveAward,props:{type:u,entity:c,post:k}})},queryProps:{id:c.id,type:u}}})}},"Show all â†’"),oe(v.o5,{type:v.kR.Callout,color:v.X8.Tertiary,className:"text-center"},"Show your appreciation! Pick an Award to send to"," ",oe(v.o5,{type:v.kR.Callout,color:v.X8.Primary,tag:v.UL.Span,bold:!0},c.receiver.name||"@".concat(c.receiver.username)),"!"),oe("div",{className:"mt-4 grid grid-cols-3 gap-2 tablet:grid-cols-4"},null==x||null===(e=x.edges)||void 0===e?void 0:e.map((function(e){var t=e.node;return oe(ce,{key:t.id,item:t,onClick:function(e){var t=e.product;if(t.value>o.balance.amount)return g({screen:T,product:t}),void n(!0);n(!1),g({screen:B,product:t})}})})))),a&&!!b&&oe(f.aF.Footer,{className:"!h-auto flex-col",justify:K.F1.Center},P&&oe(y.$n,{className:"w-full",variant:A.Ak.Primary,onClick:N},"Buy Cores ",oe(w.t,null)," ",0===b.value?"Free":(0,ee.rZ)(b.value)),!P&&oe(y.$n,{className:"w-full",variant:A.Ak.Primary,disabled:!0},oe("span",{className:"inline-flex gap-1"}," ","Insufficient Cores",oe(w.t,{secondary:!0})," "),0===b.value?"Free":(0,ee.rZ)(b.value)),oe(J,null)))},ue=function(){var e,t=(0,Y.Z2)(),r=t.updateUser,a=t.user,n=z(),o=n.setActiveStep,i=n.type,u=n.entity,d=n.product,p=n.flags,S=n.logAwardEvent,b=(0,_.G6)(_.bh.MobileL),k=(0,s.useState)(""),O=k[0],P=k[1],x=(0,m.n)({mutationKey:["awards",{productId:null==d?void 0:d.id,type:i,entityId:u.id,note:O}],mutationFn:$.CX,onSuccess:(e=(0,l.A)(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(ie(ie({},a),{},{balance:t.balance}));case 2:o({screen:D,product:d});case 3:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)}),onError:(0,ne.K)()}),N=x.mutate,R=x.isPending,h=(0,s.useCallback)((function(){S({awardEvent:"AWARD",extra:{award:d.value}}),N({productId:d.id,type:i,entityId:u.id,note:O,flags:p})}),[N,u.id,S,O,d.id,d.value,i,p]),j=!!u.numAwards;return oe(s.Fragment,null,oe(f.aF.Header,{title:"Give an Award",showCloseButton:!b},oe(y.$n,{variant:A.Ak.Tertiary,onClick:function(){return o({screen:"INTRO"})},size:A.Mp.Small,className:"mr-2 flex -rotate-90",icon:oe(g.HK,null)})),oe(f.aF.Body,null,oe("div",{className:"mb-4 flex flex-col items-center justify-center gap-2"},oe(C._V,{src:j?d.image:u.receiver.image,alt:"Award user",className:j?"size-[7.5rem]":"size-16 rounded-18"}),oe(v.o5,{type:v.kR.Callout,color:v.X8.Tertiary,className:"text-center"},"Awesome choice! We're sure that"," ",oe(v.o5,{bold:!0,type:v.kR.Callout,color:v.X8.Primary,tag:v.UL.Span},u.receiver.name||"@".concat(u.receiver.username))," ","will appreciate this award!")),oe("form",{action:"#",className:"flex flex-1 flex-col"},oe(X.A,{allowPreview:!1,textareaProps:{name:"content",rows:6,placeholder:"Share a few words about why this Award is well deserved (optional)",maxLength:400},className:{container:"flex-1"},initialContent:"",enabledCommand:{upload:!1,link:!1,mention:!1},showMarkdownGuide:!1,onValueUpdate:function(e){return P(e)}}))),oe(f.aF.Footer,{className:"!h-auto flex-col",justify:K.F1.Center},oe(y.$n,{loading:R,className:"w-full",variant:A.Ak.Primary,onClick:h},"Send Award for ",oe(w.t,null)," ",0===d.value?"Free":(0,ee.rZ)(d.value)),oe(J,null)))},de=function(){var e,t,r=z(),a=r.entity,n=r.product,o=r.onRequestClose,l=(0,_.G6)(_.bh.MobileL);return oe(f.aF.Body,null,oe("div",{className:"flex flex-col items-center justify-center gap-4"},oe("div",{className:"flex flex-col gap-2"},oe(C._V,{src:(null==n||null===(e=n.flags)||void 0===e?void 0:e.imageGlow)||n.image,alt:null==n||null===(t=n.flags)||void 0===t?void 0:t.description,className:"size-20"}),oe("div",{className:"flex items-center justify-center gap-1"},oe(w.t,{size:L.lK.Size16,className:"text-accent-bun-default"}),oe(v.o5,{type:v.kR.Footnote,color:v.X8.Secondary,tag:v.UL.Span},0===n.value?"Free":(0,ee.rZ)(n.value)))),oe("div",{className:"flex flex-col gap-2"},oe(v.o5,{type:v.kR.Title3,color:v.X8.Primary,bold:!0,className:"text-center"},"Congrats! Your Award has been sent to"," ",a.receiver.name||"@".concat(a.receiver.username)),oe(v.o5,{type:v.kR.Callout,color:v.X8.Tertiary,className:"text-center"},"Thanks for supporting the community!")),!l&&oe(y.$n,{variant:A.Ak.Primary,className:"w-full",onClick:function(){o(void 0)}},"Close")))},pe=function(){var e=z().activeStep;return oe(s.Fragment,null,"INTRO"===e?oe(se,null):null,"COMMENT"===e?oe(ue,null):null,"SUCCESS"===e?oe(de,null):null)},me=function(e){var t,r=(0,n.A)({},((0,a.A)(e),e)),o=(0,_.G6)(_.bh.MobileL),l=z(),i=l.activeStep,c=l.activeModal,u=l.setActiveModal,p=l.product,m=l.logAwardEvent,v=l.onRequestClose,y=(0,s.useRef)(!1);(0,s.useEffect)((function(){y.current||(y.current=!0,m({awardEvent:"START"}))}),[m]);var A=(0,s.useCallback)((function(){u("AWARD")}),[u]),w=(0,s.useCallback)((function(){u("AWARD")}),[u]);return oe(s.Fragment,null,"AWARD_ANIMATION"===c&&oe(re.b,{src:(null==p||null===(t=p.flags)||void 0===t?void 0:t.imageGlow)||(null==p?void 0:p.image),alt:null==p?void 0:p.name,onDone:function(){var e;null===(e=r.onRequestClose)||void 0===e||e.call(r,void 0)}}),"AWARD"===c?oe(f.aF,(0,n.A)({kind:o?q.UB.FlexibleTop:f.aF.Kind.FlexibleCenter,size:f.aF.Size.Small,className:d()(o||"SUCCESS"===i?void 0:"!h-[40rem]"),isDrawerOnMobile:"SUCCESS"===i,drawerProps:{instantOpen:!0}},r,{onRequestClose:v}),oe(pe,null)):null,"BUY_CORES"===c?oe(G.IA,(0,n.A)({},r,{onCompletion:A,onRequestClose:w,product:p,origin:P.$e.Award,onPlusClick:function(){return u("BUY_CORES")}})):null)};const fe=function(e){return oe(V,e,oe(me,e))}}}]);