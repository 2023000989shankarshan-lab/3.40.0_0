"use strict";(self.webpackChunkextension=self.webpackChunkextension||[]).push([[2408],{98474:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ee});var r=n(33998),o=n(34900),i=n(22155),a=n(21441),u=n(30395),l=n.n(u),c=n(66007),s=n(24481),d=n(17398),m=(0,i.createContext)({mutateComment:null}),f=i.createElement;function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){var n,o=e.post,a=e.initialContent,u=e.replyTo,p=e.editCommentId,h=e.className,b=void 0===h?{}:h,y=e.style,g=e.onChange,C=e.showSubmit,w=void 0===C||C,O=e.showUserAvatar,j=void 0===O||O,x=e.formProps,P=void 0===x?{}:x,S=e.onClose,A=(0,i.useRef)(!0),I=null==o?void 0:o.id,N=null==o||null===(n=o.source)||void 0===n?void 0:n.id,k=(0,i.useContext)(m).mutateComment,D=k.mutateComment,T=k.isLoading,E=k.isSuccess;return f("form",(0,r.A)({},P,{action:"#",onSubmit:function(e){if(e.preventDefault(),T||E)return null;var t=(0,d.Y)(e.currentTarget).content;return D(t)},className:null==b?void 0:b.container,style:y,ref:t}),f(s.A,{ref:function(e){e&&A.current&&(e.textareaRef.current.focus(),A.current=!1)},className:{tab:l()("!min-h-16",null==b?void 0:b.tab),input:l()(null==b?void 0:b.input,u&&"mt-0"),profile:u&&"!mt-0",container:null==b?void 0:b.markdownContainer},postId:I,sourceId:N,showUserAvatar:j,isLoading:T,disabledSubmit:E,initialContent:a,textareaProps:{name:"content",rows:7,placeholder:"Share your thoughts"},onSubmit:function(e){if(T||E)return null;var t=e.currentTarget.value;return D(t)},enabledCommand:v(v({},c.RS),{},{upload:!0}),submitCopy:w&&(p?"Update":"Comment"),timeline:u?f("span",{className:"py-2 pl-12 text-text-tertiary typo-caption1"},"Reply to",f("span",{className:"ml-2 font-bold text-text-primary"},u)):null,onValueUpdate:g,onClose:S}))}var b=(0,i.forwardRef)(h),y=n(72870),g=n(35001),C=n(13318),w=n.n(C),O=n(5698),j=n(94198),x=n(15751),P=n(64052),S=n(80009),A=n(99604),I=n(57952),N=n(11924),k=n(93526),D=n(30530),T=n(51722),E=n(61663),R=n(91201),F=n(80244);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t,n=e.post,r=e.editCommentId,o=e.parentCommentId,a=e.onCommented,u=null==n||null===(t=n.source)||void 0===t?void 0:t.id,l=null==n?void 0:n.id,c=null!=o?o:l,s=(0,F.Z2)().user,d=(0,O.jE)(),m=(0,R.D)(),f=m.requestMethod,p=m.isCompanion,v=(0,E.DX)().logEvent,h=(0,i.useContext)(k.c).logOpts,b=(0,i.useMemo)((function(){return D.$h.apply(void 0,[D.jZ.PostCommentsMutations,s].concat((0,P.A)([l,u,r,o].filter((function(e){return!!e})))))}),[s,l,u,r,o]),y=function(e){if(e){var t=function(t){if(!t)return t;var n=structuredClone(t);if(!r){var i=function(e){return{node:K(K({},e),{},{children:{edges:[],pageInfo:null}})}}(e);if(!o)return n.postComments.edges.unshift(i),n;var a=n.postComments.edges.findIndex((function(e){return e.node.id===o}));return n.postComments.edges[a].node.children.edges.push(i),n}if(!o){var u=n.postComments.edges.findIndex((function(e){return e.node.id===r}));return n.postComments.edges[u].node=K(K({},e),{},{children:n.postComments.edges[u].node.children}),n}var l=n.postComments.edges.find((function(e){return e.node.id===o})),c=l.node.children.edges.findIndex((function(e){return e.node.id===r}));return l.node.children.edges[c].node=K(K({},e),{},{children:l.node.children}),n},i=[];(0,D.w$)(l).forEach((function(e){d.setQueryData(e,(function(n){return n?t(n):(i.push(e),null)}))})),i.forEach(function(){var e=(0,g.A)(w().mark((function e(t){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.invalidateQueries({queryKey:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r||((0,D.kh)(d,l,{numComments:n.numComments+1}),v((0,N.P5)(I.VB.CommentPost,n,K({extra:{commentId:o}},h&&h)))),a&&a(e,!r,o)}},C=o?A.Uk:A.Fe,j=(0,S.n)({mutationFn:function(e){return f(C,e,{requestKey:JSON.stringify(b)})},onSuccess:function(e){return y(null==e?void 0:e.comment)}}),x=j.mutateAsync,M=j.isPending,q=j.isSuccess;(0,T.X)(b,{enabled:p,callback:function(e){var t=e.res;return y(null==t?void 0:t.comment)}});var L=(0,S.n)({mutationFn:function(e){return f(A.fK,e,{requestKey:JSON.stringify(b)})},onSuccess:function(e){return y(null==e?void 0:e.comment)}}),U=L.mutateAsync,V=L.isPending;return{mutateComment:(0,i.useCallback)((function(e){return r?U({id:r,content:e}):x({content:e,id:c})}),[r,c,U,x]),isLoading:M||V,isSuccess:q}},L=n(4004),U=function(){var e,t,n,r;return{width:null!==(e=null===globalThis||void 0===globalThis||null===(t=globalThis.window)||void 0===t||null===(t=t.visualViewport)||void 0===t?void 0:t.width)&&void 0!==e?e:0,height:null!==(n=null===globalThis||void 0===globalThis||null===(r=globalThis.window)||void 0===r||null===(r=r.visualViewport)||void 0===r?void 0:r.height)&&void 0!==n?n:0}},V=function(){var e,t=(0,i.useState)(U),n=t[0],r=t[1];return(0,L.M)(null===globalThis||void 0===globalThis||null===(e=globalThis.window)||void 0===e?void 0:e.visualViewport,"resize",(function(){return r(U)})),n},z=n(57434),H=n(68334),Q=n(91480),$=n(86242),_=i.createElement;function B(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var Z=function(e,t){var n,r;if(null!=e&&null!==(n=e.postComments)&&void 0!==n&&n.edges){var o,i=B(null==e||null===(r=e.postComments)||void 0===r?void 0:r.edges);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(a.node.id===t)return a.node;if(a.node.children){var u,l=B(a.node.children.edges);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(c.node.id===t)return c.node}}catch(e){l.e(e)}finally{l.f()}}}}catch(e){i.e(e)}finally{i.f()}}},X=function(e){var t=e.client,n=e.postId,r=e.commentId;if(r){var o,i=B((0,D.w$)(n));try{for(i.s();!(o=i.n()).done;){var a=o.value,u=Z(t.getQueryData(a),r);if(u)return u}}catch(e){i.e(e)}finally{i.f()}}};function Y(e){var t,n,r,o,a,u,c,s,d,f,p=e.isOpen,v=e.onRequestClose,h=e.onAfterClose,y=e.onCommented,C=e.parentCommentId,P=e.replyToCommentId,S=e.editCommentId,A=e.post,N=e.initialContent,k=(0,i.useRef)(null),D=(0,i.useRef)(null),T=(0,i.useRef)(null),E=(0,i.useRef)(null),R=(0,F.Z2)().user,M=(0,O.jE)(),K=(0,i.useState)(null),L=K[0],U=K[1],B=!!S,J=!B&&!!P,Z=(0,$.A)({id:S,options:{enabled:!!S}}).comment,Y=(0,i.useCallback)((function(e){e&&U(e)}),[U]),W=(0,z.$)({source:I.vH.NewComment}),G=W.shouldShowCta,ee=W.isEnabled,te=W.onToggle,ne=W.onSubmitted,re=(0,i.useMemo)((function(){return X({client:M,postId:null==A?void 0:A.id,commentId:B?S:null!=P?P:C})}),[M,null==A?void 0:A.id,B,S,C,P]),oe=q({post:A,editCommentId:B&&S,parentCommentId:C,onCommented:function(e,t,n){y&&y(e,t,n),v()}}),ie=oe.isLoading,ae=oe.isSuccess;(0,i.useLayoutEffect)((function(){var e;null==L||null===(e=L.scrollTo)||void 0===e||e.call(L,{behavior:"auto",top:1e4})}),[L]);var ue=V().height,le=null!==(t=null===(n=T.current)||void 0===n?void 0:n.clientHeight)&&void 0!==t?t:0,ce=null!==(r=null===(o=E.current)||void 0===o?void 0:o.clientHeight)&&void 0!==r?r:0,se=ue-(null!==(a=null===(u=D.current)||void 0===u?void 0:u.offsetHeight)&&void 0!==a?a:0)-le-ce,de=se>0?Math.max(se,300):"auto";k.current&&(null===(c=k.current.style)||void 0===c?void 0:c.height)!=="".concat(de,"px")&&(k.current.style.height="".concat(de,"px"));var me,fe=(0,i.useMemo)((function(){return B?{submitCopy:"Save",initialContent:null==Z?void 0:Z.content}:J?{submitCopy:"Reply",initialContent:null!=re&&null!==(e=re.author)&&void 0!==e&&e.id&&re.author.id!==(null==R?void 0:R.id)?"@".concat(null==re||null===(t=re.author)||void 0===t?void 0:t.username," "):void 0}:{submitCopy:"Comment",initialContent:N};var e,t}),[B,J,re,Z,null==R?void 0:R.id,N]),pe=fe.submitCopy,ve=fe.initialContent;return _(j.aF,{isOpen:p,onRequestClose:v,onAfterClose:h,className:"!border-none",overlayClassName:"!touch-none"},_(j.aF.Body,{className:"!p-0",ref:Y},_(m.Provider,{value:{mutateComment:oe}},_(x._,{form:"write-comment",copy:{right:pe},leftButtonProps:{onClick:v},rightButtonProps:{onClick:(me=(0,g.A)(w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:case"end":return e.stop()}}),e)}))),function(){return me.apply(this,arguments)}),loading:ie,disabled:ae},className:{container:"flex-1 first:!border-none",header:"sticky top-0 z-2 w-full bg-background-default"},headerRef:D},J&&re&&_(i.Fragment,null,_(Q.A,{post:A,comment:re,className:{container:"mx-4 mt-4 border"},postAuthorId:null==A||null===(s=A.author)||void 0===s?void 0:s.id,postScoutId:null==A||null===(d=A.scout)||void 0===d?void 0:d.id}),_("div",{className:"ml-12 flex gap-2 border-l border-border-subtlest-tertiary py-3 pl-5 text-text-tertiary typo-caption1",ref:T},"Reply to",_("span",{className:"font-bold text-text-primary"},null===(f=re.author)||void 0===f?void 0:f.username))),_(b,{ref:k,replyTo:null,post:A,parentCommentId:C,editCommentId:B&&S,initialContent:ve,className:{markdownContainer:"flex-1",container:l()("flex flex-col",J?"h-[calc(100%-2.5rem)]":"h-full"),tab:"flex-1",input:"comment-input-123 !max-h-none flex-1"},showSubmit:!1,showUserAvatar:!1,formProps:{id:"write-comment"}}),G&&_(H.d,{inputId:"push_notification-switch",name:"push_notification",labelClassName:"flex-1 font-normal",className:"px-3 py-3.5",compact:!1,checked:ee,onToggle:te,ref:E},"Receive updates when other members engage")))))}var W=["onClose","className"],G=i.createElement;function ee(e){var t=e.onClose,n=e.className,i=(0,o.A)(e,W),a=!(0,y.G6)(y.bh.Tablet),u=q({post:i.post,editCommentId:i.editCommentId,parentCommentId:i.parentCommentId,onCommented:i.onCommented});return a?G(Y,(0,r.A)({},i,{isOpen:!0,onRequestClose:t})):G(m.Provider,{value:{mutateComment:u}},G(b,(0,r.A)({},i,{className:n.input,onClose:t})))}},68334:(e,t,n)=>{n.d(t,{d:()=>v});var r=n(33998),o=n(34900),i=n(22155),a=n(30395),u=n.n(a);const l="_5r2X27zKbL3K-0KuztabLA==",c="_9VJTarzDvJAPMOKQbzHeEQ==",s="+hRUmPa5hVn8ncwI9jw3WQ==",d="D5NR++a7+cgnxCM1YywMSg==";var m=["className","labelClassName","inputId","name","checked","children","onToggle","compact","defaultTypo","disabled"],f=i.createElement;function p(e,t){var n=e.className,i=e.labelClassName,a=e.inputId,p=e.name,v=e.checked,h=e.children,b=e.onToggle,y=e.compact,g=void 0===y||y,C=e.defaultTypo,w=void 0===C||C,O=e.disabled,j=(0,o.A)(e,m);return f("label",{className:u()(n,"group relative flex items-center",O?"pointer-events-none cursor-not-allowed opacity-32":"cursor-pointer",s),htmlFor:a,ref:t},f("input",(0,r.A)({},j,{disabled:O,id:a,name:p,type:"checkbox",checked:v,onChange:b,className:"absolute h-0 w-0 opacity-0"})),f("span",{className:u()("relative block",g?"h-4 w-8":"h-5 w-10")},f("span",{className:u()("absolute bottom-0 left-0 top-0 my-auto w-full bg-theme-overlay-quaternary",g?"h-2.5 rounded-3":"h-3 rounded-4",l)}),f("span",{className:u()("absolute left-0 top-0 bg-text-tertiary",g?"h-4 w-4 rounded-3":"h-5 w-5 rounded-6",c)})),h&&f("span",{className:u()("ml-3 font-bold text-text-tertiary",w&&"typo-footnote",d,i)},h))}var v=i.forwardRef(p)},57434:(e,t,n)=>{n.d(t,{$:()=>c});var r=n(35001),o=n(13318),i=n.n(o),a=n(22155),u=n(57952),l=n(35393),c=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).source,t=void 0===e?u.vH.SquadPostCommentary:e,n=(0,a.useState)(!0),o=n[0],c=n[1],s=(0,l.W)({source:t}),d=s.shouldShowCta,m=s.onEnable,f=s.onDismiss,p=function(){var e=(0,r.A)(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return e.abrupt("return");case 2:return t=o?m:f,e.next=5,t();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=(0,a.useCallback)((function(){return c((function(e){return!e}))}),[]);return{isEnabled:o,onToggle:v,shouldShowCta:d,onSubmitted:p}}},17398:(e,t,n)=>{n.d(t,{Y:()=>a});var r=n(21441);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){return Array.from(e.elements).reduce((function(e,t){return""===t.name?e:"checkbox"===t.type?i(i({},e),{},(0,r.A)({},t.name,t.checked)):"radio"!==t.type||t.checked?"file"===t.type?i(i({},e),{},(0,r.A)({},t.name,0===t.files.length?null:t.files)):i(i({},e),{},(0,r.A)({},t.name,t.value.length?t.value:null)):e}),t)}},73855:(e,t,n)=>{n.d(t,{NF:()=>c,PK:()=>a,rZ:()=>l,vv:()=>u});var r=n(21441),o=n(81602);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var a=function(e){return"string"==typeof e&&"true"===e.toLowerCase()},u=function(e,t){return"number"!=typeof e?"":e.toLocaleString(["en-US"],function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({minimumFractionDigits:2,maximumFractionDigits:2},t))},l=function(e){return e>1e5?(0,o.Kt)(e):u(e,{minimumFractionDigits:0})},c=function(e){var t=e.currency,n=e.amount;return new Intl.NumberFormat(navigator.language,{minimumFractionDigits:2,maximumFractionDigits:2,style:"currency",currency:t}).format(n)}}}]);